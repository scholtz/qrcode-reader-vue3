const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/adapter_core.CEti_sgG.js","assets/chunks/utils.DdGZ3POZ.js","assets/chunks/getusermedia.D3hymGKc.js","assets/chunks/getusermedia.D7MBqdid.js","assets/chunks/safari_shim.tcOtNX9D.js"])))=>i.map(i=>d[i]);
import{d as za,p as qa,v as Ga,am as Na,b as Qa,o as Lt,H as Xa,V as Ot,_ as ne,c as ae,ah as Qe,j as It,ak as Xe,r as Ze,a0 as Mt}from"./framework.CYp0bhgW.js";const li=za({__name:"DemoWrapper",props:{component:Object},setup(n){const s=n,l=qa();return Ga(()=>{s.component&&(l.value=Na(s.component))}),(p,h)=>(Lt(),Qa(Xa(l.value)))}});class Ja extends Error{constructor(){super("can't process cross-origin image"),this.name="DropImageFetchError"}}class tr extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class Ka extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}var er=n=>{throw TypeError(n)},rr=(n,s,l)=>s.has(n)||er("Cannot "+l),Ya=(n,s,l)=>(rr(n,s,"read from private field"),l?l.call(n):s.get(n)),Za=(n,s,l)=>s.has(n)?er("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(n):s.set(n,l),to=(n,s,l,p)=>(rr(n,s,"write to private field"),s.set(n,l),l);const jt=[["Aztec","M"],["Codabar","L"],["Code39","L"],["Code93","L"],["Code128","L"],["DataBar","L"],["DataBarExpanded","L"],["DataMatrix","M"],["EAN-8","L"],["EAN-13","L"],["ITF","L"],["MaxiCode","M"],["PDF417","M"],["QRCode","M"],["UPC-A","L"],["UPC-E","L"],["MicroQRCode","M"],["rMQRCode","M"],["DXFilmEdge","L"],["DataBarLimited","L"]],Ut=jt.map(([n])=>n),eo=Ut.filter((n,s)=>jt[s][1]==="L"),ro=Ut.filter((n,s)=>jt[s][1]==="M");function ee(n){switch(n){case"Linear-Codes":return eo.reduce((s,l)=>s|ee(l),0);case"Matrix-Codes":return ro.reduce((s,l)=>s|ee(l),0);case"Any":return(1<<jt.length)-1;case"None":return 0;default:return 1<<Ut.indexOf(n)}}function no(n){if(n===0)return"None";const s=31-Math.clz32(n);return Ut[s]}function ao(n){return n.reduce((s,l)=>s|ee(l),0)}const oo=["LocalAverage","GlobalHistogram","FixedThreshold","BoolCast"];function io(n){return oo.indexOf(n)}const Je=["Unknown","ASCII","ISO8859_1","ISO8859_2","ISO8859_3","ISO8859_4","ISO8859_5","ISO8859_6","ISO8859_7","ISO8859_8","ISO8859_9","ISO8859_10","ISO8859_11","ISO8859_13","ISO8859_14","ISO8859_15","ISO8859_16","Cp437","Cp1250","Cp1251","Cp1252","Cp1256","Shift_JIS","Big5","GB2312","GB18030","EUC_JP","EUC_KR","UTF16BE","UTF16BE","UTF8","UTF16LE","UTF32BE","UTF32LE","BINARY"];function so(n){return n==="UnicodeBig"?Je.indexOf("UTF16BE"):Je.indexOf(n)}const co=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function uo(n){return co[n]}const lo=["Ignore","Read","Require"];function ho(n){return lo.indexOf(n)}const fo=["Plain","ECI","HRI","Hex","Escaped"];function po(n){return fo.indexOf(n)}const Ft={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,tryDenoise:!1,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!0,returnErrors:!1,eanAddOnSymbol:"Ignore",textMode:"HRI",characterSet:"Unknown"};function Ke(n){return{...n,formats:ao(n.formats),binarizer:io(n.binarizer),eanAddOnSymbol:ho(n.eanAddOnSymbol),textMode:po(n.textMode),characterSet:so(n.characterSet)}}function mo(n){return{...n,format:no(n.format),contentType:uo(n.contentType),eccLevel:n.ecLevel}}const vo={locateFile:(n,s)=>{const l=n.match(/_(.+?)\.wasm$/);return l?`https://fastly.jsdelivr.net/npm/zxing-wasm@2.2.4/dist/${l[1]}/${n}`:s+n}},te=new WeakMap;function go(n,s){return Object.is(n,s)||Object.keys(n).length===Object.keys(s).length&&Object.keys(n).every(l=>Object.hasOwn(s,l)&&n[l]===s[l])}function nr(n,{overrides:s,equalityFn:l=go,fireImmediately:p=!1}={}){var h;const[g,C]=(h=te.get(n))!=null?h:[vo],P=s??g;let T;if(p){if(C&&(T=l(g,P)))return C;const S=n({...P});return te.set(n,[P,S]),S}(T??l(g,P))||te.set(n,[P])}async function yo(n,s,l=Ft){const p={...Ft,...l},h=await nr(n,{fireImmediately:!0});let g,C;if("width"in s&&"height"in s&&"data"in s){const{data:T,data:{byteLength:S},width:F,height:R}=s;C=h._malloc(S),h.HEAPU8.set(T,C),g=h.readBarcodesFromPixmap(C,F,R,Ke(p))}else{let T,S;if("buffer"in s)[T,S]=[s.byteLength,s];else if("byteLength"in s)[T,S]=[s.byteLength,new Uint8Array(s)];else if("size"in s)[T,S]=[s.size,new Uint8Array(await s.arrayBuffer())];else throw new TypeError("Invalid input type");C=h._malloc(T),h.HEAPU8.set(S,C),g=h.readBarcodesFromImage(C,T,Ke(p))}h._free(C);const P=[];for(let T=0;T<g.size();++T)P.push(mo(g.get(T)));return P}({...Ft,formats:[...Ft.formats]});async function ar(n={}){var s,l,p,h=n,g=!!globalThis.window,C=typeof Bun<"u",P=!!globalThis.WorkerGlobalScope;!((l=globalThis.process)===null||l===void 0||(l=l.versions)===null||l===void 0)&&l.node&&((p=globalThis.process)===null||p===void 0?void 0:p.type)!="renderer";var T="./this.program",S,F="";function R(t){return h.locateFile?h.locateFile(t,F):F+t}var L,j;if(g||P||C){try{F=new URL(".",S).href}catch{}P&&(j=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),L=async t=>{var e=await fetch(t,{credentials:"same-origin"});if(e.ok)return e.arrayBuffer();throw new Error(e.status+" : "+e.url)}}var k=console.log.bind(console),W=console.error.bind(console),V,rt=!1,ft,se,K,G,pt,ot,it,E,ce,ue,le=!1;function de(){var t=St.buffer;K=new Int8Array(t),pt=new Int16Array(t),h.HEAPU8=G=new Uint8Array(t),ot=new Uint16Array(t),it=new Int32Array(t),E=new Uint32Array(t),ce=new Float32Array(t),ue=new Float64Array(t)}function vr(){if(h.preRun)for(typeof h.preRun=="function"&&(h.preRun=[h.preRun]);h.preRun.length;)xr(h.preRun.shift());he(pe)}function gr(){le=!0,dt.xa()}function yr(){if(h.postRun)for(typeof h.postRun=="function"&&(h.postRun=[h.postRun]);h.postRun.length;)Sr(h.postRun.shift());he(fe)}function Bt(t){var e,r;(e=h.onAbort)===null||e===void 0||e.call(h,t),t="Aborted("+t+")",W(t),rt=!0,t+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(t);throw(r=se)===null||r===void 0||r(a),a}var mt;function wr(){return R("zxing_reader.wasm")}function br(t){if(t==mt&&V)return new Uint8Array(V);if(j)return j(t);throw"both async and sync fetching of the wasm failed"}async function $r(t){if(!V)try{var e=await L(t);return new Uint8Array(e)}catch{}return br(t)}async function Cr(t,e){try{var r=await $r(t),a=await WebAssembly.instantiate(r,e);return a}catch(o){W(`failed to asynchronously prepare wasm: ${o}`),Bt(o)}}async function Tr(t,e,r){if(!t&&WebAssembly.instantiateStreaming)try{var a=fetch(e,{credentials:"same-origin"}),o=await WebAssembly.instantiateStreaming(a,r);return o}catch(i){W(`wasm streaming compile failed: ${i}`),W("falling back to ArrayBuffer instantiation")}return Cr(e,r)}function _r(){var t={a:ia};return t}async function Pr(){function t(i,c){return dt=i.exports,oa(dt),de(),dt}function e(i){return t(i.instance)}var r=_r();if(h.instantiateWasm)return new Promise((i,c)=>{h.instantiateWasm(r,(u,d)=>{i(t(u))})});mt!=null||(mt=wr());var a=await Tr(V,mt,r),o=e(a);return o}var he=t=>{for(;t.length>0;)t.shift()(h)},fe=[],Sr=t=>fe.push(t),pe=[],xr=t=>pe.push(t),w=t=>Le(t),b=()=>je(),vt=[],gt=0,Er=t=>{var e=new Wt(t);return e.get_caught()||(e.set_caught(!0),gt--),e.set_rethrown(!1),vt.push(e),Be(t),Fe(t)},N=0,Dr=()=>{y(0,0);var t=vt.pop();Ue(t.excPtr),N=0};class Wt{constructor(e){this.excPtr=e,this.ptr=e-24}set_type(e){E[this.ptr+4>>2]=e}get_type(){return E[this.ptr+4>>2]}set_destructor(e){E[this.ptr+8>>2]=e}get_destructor(){return E[this.ptr+8>>2]}set_caught(e){e=e?1:0,K[this.ptr+12]=e}get_caught(){return K[this.ptr+12]!=0}set_rethrown(e){e=e?1:0,K[this.ptr+13]=e}get_rethrown(){return K[this.ptr+13]!=0}init(e,r){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(r)}set_adjusted_ptr(e){E[this.ptr+16>>2]=e}get_adjusted_ptr(){return E[this.ptr+16>>2]}}var yt=t=>Re(t),kt=t=>{var e=N;if(!e)return yt(0),0;var r=new Wt(e);r.set_adjusted_ptr(e);var a=r.get_type();if(!a)return yt(0),e;for(var o of t){if(o===0||o===a)break;var i=r.ptr+16;if(We(o,a,i))return yt(o),e}return yt(a),e},Or=()=>kt([]),Ir=t=>kt([t]),Mr=(t,e)=>kt([t,e]),Ar=()=>{var t=vt.pop();t||Bt("no exception to throw");var e=t.excPtr;throw t.get_rethrown()||(vt.push(t),t.set_rethrown(!0),t.set_caught(!1),gt++),N=e,N},Fr=(t,e,r)=>{var a=new Wt(t);throw a.init(e,r),N=t,gt++,N},Rr=()=>gt,Lr=t=>{throw N||(N=t),N},jr=()=>Bt(""),wt={},Vt=t=>{for(;t.length;){var e=t.pop(),r=t.pop();r(e)}};function st(t){return this.fromWireType(E[t>>2])}var nt={},Y={},bt={},Ur=class extends Error{constructor(t){super(t),this.name="InternalError"}},$t=t=>{throw new Ur(t)},Z=(t,e,r)=>{t.forEach(u=>bt[u]=e);function a(u){var d=r(u);d.length!==t.length&&$t("Mismatched type converter count");for(var f=0;f<t.length;++f)z(t[f],d[f])}var o=new Array(e.length),i=[],c=0;{const u=e;for(let d=0;d<u.length;++d){const f=u[d];Y.hasOwnProperty(f)?o[d]=Y[f]:(i.push(f),nt.hasOwnProperty(f)||(nt[f]=[]),nt[f].push(()=>{o[d]=Y[f],++c,c===i.length&&a(o)}))}}i.length===0&&a(o)},Br=t=>{var e=wt[t];delete wt[t];var r=e.rawConstructor,a=e.rawDestructor,o=e.fields,i=o.map(c=>c.getterReturnType).concat(o.map(c=>c.setterArgumentType));Z([t],i,c=>{var u={};{const d=o;for(let f=0;f<d.length;++f){const m=d[f],v=c[f],x=m.getter,O=m.getterContext,A=c[f+o.length],M=m.setter,I=m.setterContext;u[m.fieldName]={read:D=>v.fromWireType(x(O,D)),write:(D,et)=>{var B=[];M(I,D,A.toWireType(B,et)),Vt(B)},optional:v.optional}}}return[{name:e.name,fromWireType:d=>{var f={};for(var m in u)f[m]=u[m].read(d);return a(d),f},toWireType:(d,f)=>{for(var m in u)if(!(m in f)&&!u[m].optional)throw new TypeError(`Missing field: "${m}"`);var v=r();for(m in u)u[m].write(v,f[m]);return d!==null&&d.push(a,v),v},readValueFromPointer:st,destructorFunction:a}]})},Wr=(t,e,r,a,o)=>{},U=t=>{for(var e="";;){var r=G[t++];if(!r)return e;e+=String.fromCharCode(r)}},ct=class extends Error{constructor(t){super(t),this.name="BindingError"}},_=t=>{throw new ct(t)};function kr(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var a=e.name;if(t||_(`type "${a}" must have a positive integer typeid pointer`),Y.hasOwnProperty(t)){if(r.ignoreDuplicateRegistrations)return;_(`Cannot register type '${a}' twice`)}if(Y[t]=e,delete bt[t],nt.hasOwnProperty(t)){var o=nt[t];delete nt[t],o.forEach(i=>i())}}function z(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return kr(t,e,r)}var Vr=(t,e,r,a)=>{e=U(e),z(t,{name:e,fromWireType:function(o){return!!o},toWireType:function(o,i){return i?r:a},readValueFromPointer:function(o){return this.fromWireType(G[o])},destructorFunction:null})},Hr=t=>({count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}),Ht=t=>{function e(r){return r.$$.ptrType.registeredClass.name}_(e(t)+" instance already deleted")},zt=!1,me=t=>{},zr=t=>{t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)},ve=t=>{t.count.value-=1;var e=t.count.value===0;e&&zr(t)},ut=t=>globalThis.FinalizationRegistry?(zt=new FinalizationRegistry(e=>{ve(e.$$)}),ut=e=>{var r=e.$$,a=!!r.smartPtr;if(a){var o={$$:r};zt.register(e,o,e)}return e},me=e=>zt.unregister(e),ut(t)):(ut=e=>e,t),qr=()=>{let t=Ct.prototype;Object.assign(t,{isAliasOf(r){if(!(this instanceof Ct)||!(r instanceof Ct))return!1;var a=this.$$.ptrType.registeredClass,o=this.$$.ptr;r.$$=r.$$;for(var i=r.$$.ptrType.registeredClass,c=r.$$.ptr;a.baseClass;)o=a.upcast(o),a=a.baseClass;for(;i.baseClass;)c=i.upcast(c),i=i.baseClass;return a===i&&o===c},clone(){if(this.$$.ptr||Ht(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var r=ut(Object.create(Object.getPrototypeOf(this),{$$:{value:Hr(this.$$)}}));return r.$$.count.value+=1,r.$$.deleteScheduled=!1,r},delete(){this.$$.ptr||Ht(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_("Object already scheduled for deletion"),me(this),ve(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||Ht(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const e=Symbol.dispose;e&&(t[e]=t.delete)};function Ct(){}var qt=(t,e)=>Object.defineProperty(e,"name",{value:t}),ge={},ye=(t,e,r)=>{if(t[e].overloadTable===void 0){var a=t[e];t[e]=function(){for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return t[e].overloadTable.hasOwnProperty(i.length)||_(`Function '${r}' called with an invalid number of arguments (${i.length}) - expects one of (${t[e].overloadTable})!`),t[e].overloadTable[i.length].apply(this,i)},t[e].overloadTable=[],t[e].overloadTable[a.argCount]=a}},we=(t,e,r)=>{h.hasOwnProperty(t)?((r===void 0||h[t].overloadTable!==void 0&&h[t].overloadTable[r]!==void 0)&&_(`Cannot register public name '${t}' twice`),ye(h,t,t),h[t].overloadTable.hasOwnProperty(r)&&_(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),h[t].overloadTable[r]=e):(h[t]=e,h[t].argCount=r)},Gr=48,Nr=57,Qr=t=>{t=t.replace(/[^a-zA-Z0-9_]/g,"$");var e=t.charCodeAt(0);return e>=Gr&&e<=Nr?`_${t}`:t};function Xr(t,e,r,a,o,i,c,u){this.name=t,this.constructor=e,this.instancePrototype=r,this.rawDestructor=a,this.baseClass=o,this.getActualType=i,this.upcast=c,this.downcast=u,this.pureVirtualFunctions=[]}var Gt=(t,e,r)=>{for(;e!==r;)e.upcast||_(`Expected null or instance of ${r.name}, got an instance of ${e.name}`),t=e.upcast(t),e=e.baseClass;return t},Nt=t=>{if(t===null)return"null";var e=typeof t;return e==="object"||e==="array"||e==="function"?t.toString():""+t};function Jr(t,e){if(e===null)return this.isReference&&_(`null is not a valid ${this.name}`),0;e.$$||_(`Cannot pass "${Nt(e)}" as a ${this.name}`),e.$$.ptr||_(`Cannot pass deleted object as a pointer of type ${this.name}`);var r=e.$$.ptrType.registeredClass,a=Gt(e.$$.ptr,r,this.registeredClass);return a}function Kr(t,e){var r;if(e===null)return this.isReference&&_(`null is not a valid ${this.name}`),this.isSmartPointer?(r=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,r),r):0;(!e||!e.$$)&&_(`Cannot pass "${Nt(e)}" as a ${this.name}`),e.$$.ptr||_(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&e.$$.ptrType.isConst&&_(`Cannot convert argument of type ${e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name} to parameter type ${this.name}`);var a=e.$$.ptrType.registeredClass;if(r=Gt(e.$$.ptr,a,this.registeredClass),this.isSmartPointer)switch(e.$$.smartPtr===void 0&&_("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:e.$$.smartPtrType===this?r=e.$$.smartPtr:_(`Cannot convert argument of type ${e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=e.$$.smartPtr;break;case 2:if(e.$$.smartPtrType===this)r=e.$$.smartPtr;else{var o=e.clone();r=this.rawShare(r,q.toHandle(()=>o.delete())),t!==null&&t.push(this.rawDestructor,r)}break;default:_("Unsupporting sharing policy")}return r}function Yr(t,e){if(e===null)return this.isReference&&_(`null is not a valid ${this.name}`),0;e.$$||_(`Cannot pass "${Nt(e)}" as a ${this.name}`),e.$$.ptr||_(`Cannot pass deleted object as a pointer of type ${this.name}`),e.$$.ptrType.isConst&&_(`Cannot convert argument of type ${e.$$.ptrType.name} to parameter type ${this.name}`);var r=e.$$.ptrType.registeredClass,a=Gt(e.$$.ptr,r,this.registeredClass);return a}var be=(t,e,r)=>{if(e===r)return t;if(r.baseClass===void 0)return null;var a=be(t,e,r.baseClass);return a===null?null:r.downcast(a)},Zr={},tn=(t,e)=>{for(e===void 0&&_("ptr should not be undefined");t.baseClass;)e=t.upcast(e),t=t.baseClass;return e},en=(t,e)=>(e=tn(t,e),Zr[e]),Tt=(t,e)=>{(!e.ptrType||!e.ptr)&&$t("makeClassHandle requires ptr and ptrType");var r=!!e.smartPtrType,a=!!e.smartPtr;return r!==a&&$t("Both smartPtrType and smartPtr must be specified"),e.count={value:1},ut(Object.create(t,{$$:{value:e,writable:!0}}))};function rn(t){var e=this.getPointee(t);if(!e)return this.destructor(t),null;var r=en(this.registeredClass,e);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=e,r.$$.smartPtr=t,r.clone();var a=r.clone();return this.destructor(t),a}function o(){return this.isSmartPointer?Tt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:e,smartPtrType:this,smartPtr:t}):Tt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var i=this.registeredClass.getActualType(e),c=ge[i];if(!c)return o.call(this);var u;this.isConst?u=c.constPointerType:u=c.pointerType;var d=be(e,this.registeredClass,u.registeredClass);return d===null?o.call(this):this.isSmartPointer?Tt(u.registeredClass.instancePrototype,{ptrType:u,ptr:d,smartPtrType:this,smartPtr:t}):Tt(u.registeredClass.instancePrototype,{ptrType:u,ptr:d})}var nn=()=>{Object.assign(_t.prototype,{getPointee(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t},destructor(t){var e;(e=this.rawDestructor)===null||e===void 0||e.call(this,t)},readValueFromPointer:st,fromWireType:rn})};function _t(t,e,r,a,o,i,c,u,d,f,m){this.name=t,this.registeredClass=e,this.isReference=r,this.isConst=a,this.isSmartPointer=o,this.pointeeType=i,this.sharingPolicy=c,this.rawGetPointee=u,this.rawConstructor=d,this.rawShare=f,this.rawDestructor=m,!o&&e.baseClass===void 0?a?(this.toWireType=Jr,this.destructorFunction=null):(this.toWireType=Yr,this.destructorFunction=null):this.toWireType=Kr}var $e=(t,e,r)=>{h.hasOwnProperty(t)||$t("Replacing nonexistent public symbol"),h[t].overloadTable!==void 0&&r!==void 0?h[t].overloadTable[r]=e:(h[t]=e,h[t].argCount=r)},X={},an=(t,e,r)=>{t=t.replace(/p/g,"i");var a=X[t];return a(e,...r)},Ce=[],$=t=>{var e=Ce[t];return e||(Ce[t]=e=He.get(t)),e},on=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(t.includes("j"))return an(t,e,r);var a=$(e),o=a(...r);return o},sn=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function(){for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return on(t,e,o,r)}},H=function(t,e){t=U(t);function r(){if(t.includes("j"))return sn(t,e);var o=$(e);return o}var a=r();return typeof a!="function"&&_(`unknown function pointer with signature ${t}: ${e}`),a};class cn extends Error{}var Te=t=>{var e=Ae(t),r=U(e);return J(e),r},Pt=(t,e)=>{var r=[],a={};function o(i){if(!a[i]&&!Y[i]){if(bt[i]){bt[i].forEach(o);return}r.push(i),a[i]=!0}}throw e.forEach(o),new cn(`${t}: `+r.map(Te).join([", "]))},un=(t,e,r,a,o,i,c,u,d,f,m,v,x)=>{m=U(m),i=H(o,i),u&&(u=H(c,u)),f&&(f=H(d,f)),x=H(v,x);var O=Qr(m);we(O,function(){Pt(`Cannot construct ${m} due to unbound types`,[a])}),Z([t,e,r],a?[a]:[],A=>{A=A[0];var M,I;a?(M=A.registeredClass,I=M.instancePrototype):I=Ct.prototype;var D=qt(m,function(){if(Object.getPrototypeOf(this)!==et)throw new ct(`Use 'new' to construct ${m}`);if(B.constructor_body===void 0)throw new ct(`${m} has no accessible constructor`);for(var Ge=arguments.length,Et=new Array(Ge),Dt=0;Dt<Ge;Dt++)Et[Dt]=arguments[Dt];var Ne=B.constructor_body[Et.length];if(Ne===void 0)throw new ct(`Tried to invoke ctor of ${m} with invalid number of parameters (${Et.length}) - expected (${Object.keys(B.constructor_body).toString()}) parameters instead!`);return Ne.apply(this,Et)}),et=Object.create(I,{constructor:{value:D}});D.prototype=et;var B=new Xr(m,D,et,x,M,i,u,f);if(B.baseClass){var Q,xt;(xt=(Q=B.baseClass).__derivedClasses)!==null&&xt!==void 0||(Q.__derivedClasses=[]),B.baseClass.__derivedClasses.push(B)}var Ha=new _t(m,B,!0,!1,!1),ze=new _t(m+"*",B,!1,!1,!1),qe=new _t(m+" const*",B,!1,!0,!1);return ge[t]={pointerType:ze,constPointerType:qe},$e(O,D),[Ha,ze,qe]})},Qt=(t,e)=>{for(var r=[],a=0;a<t;a++)r.push(E[e+a*4>>2]);return r};function ln(t){for(var e=1;e<t.length;++e)if(t[e]!==null&&t[e].destructorFunction===void 0)return!0;return!1}function Xt(t,e,r,a,o,i){var c=e.length;c<2&&_("argTypes array size mismatch! Must at least get return value and 'this' types!");var u=e[1]!==null&&r!==null,d=ln(e),f=!e[0].isVoid,m=c-2,v=new Array(m),x=[],O=[],A=function(){O.length=0;var M;x.length=u?2:1,x[0]=o,u&&(M=e[1].toWireType(O,this),x[1]=M);for(var I=0;I<m;++I)v[I]=e[I+2].toWireType(O,I<0||arguments.length<=I?void 0:arguments[I]),x.push(v[I]);var D=a(...x);function et(B){if(d)Vt(O);else for(var Q=u?1:2;Q<e.length;Q++){var xt=Q===1?M:v[Q-2];e[Q].destructorFunction!==null&&e[Q].destructorFunction(xt)}if(f)return e[0].fromWireType(B)}return et(D)};return qt(t,A)}var dn=(t,e,r,a,o,i)=>{var c=Qt(e,r);o=H(a,o),Z([],[t],u=>{u=u[0];var d=`constructor ${u.name}`;if(u.registeredClass.constructor_body===void 0&&(u.registeredClass.constructor_body=[]),u.registeredClass.constructor_body[e-1]!==void 0)throw new ct(`Cannot register multiple constructors with identical number of parameters (${e-1}) for class '${u.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return u.registeredClass.constructor_body[e-1]=()=>{Pt(`Cannot construct ${u.name} due to unbound types`,c)},Z([],c,f=>(f.splice(1,0,null),u.registeredClass.constructor_body[e-1]=Xt(d,f,null,o,i),[])),[]})},_e=t=>{t=t.trim();const e=t.indexOf("(");return e===-1?t:t.slice(0,e)},hn=(t,e,r,a,o,i,c,u,d,f)=>{var m=Qt(r,a);e=U(e),e=_e(e),i=H(o,i),Z([],[t],v=>{v=v[0];var x=`${v.name}.${e}`;e.startsWith("@@")&&(e=Symbol[e.substring(2)]),u&&v.registeredClass.pureVirtualFunctions.push(e);function O(){Pt(`Cannot call ${x} due to unbound types`,m)}var A=v.registeredClass.instancePrototype,M=A[e];return M===void 0||M.overloadTable===void 0&&M.className!==v.name&&M.argCount===r-2?(O.argCount=r-2,O.className=v.name,A[e]=O):(ye(A,e,x),A[e].overloadTable[r-2]=O),Z([],m,I=>{var D=Xt(x,I,v,i,c);return A[e].overloadTable===void 0?(D.argCount=r-2,A[e]=D):A[e].overloadTable[r-2]=D,[]}),[]})},Pe=[],tt=[0,1,,1,null,1,!0,1,!1,1],Jt=t=>{t>9&&--tt[t+1]===0&&(tt[t]=void 0,Pe.push(t))},q={toValue:t=>(t||_(`Cannot use deleted val. handle = ${t}`),tt[t]),toHandle:t=>{switch(t){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const e=Pe.pop()||tt.length;return tt[e]=t,tt[e+1]=1,e}}}},Se={name:"emscripten::val",fromWireType:t=>{var e=q.toValue(t);return Jt(t),e},toWireType:(t,e)=>q.toHandle(e),readValueFromPointer:st,destructorFunction:null},fn=t=>z(t,Se),pn=(t,e)=>{switch(e){case 4:return function(r){return this.fromWireType(ce[r>>2])};case 8:return function(r){return this.fromWireType(ue[r>>3])};default:throw new TypeError(`invalid float width (${e}): ${t}`)}},mn=(t,e,r)=>{e=U(e),z(t,{name:e,fromWireType:a=>a,toWireType:(a,o)=>o,readValueFromPointer:pn(e,r),destructorFunction:null})},vn=(t,e,r,a,o,i,c,u)=>{var d=Qt(e,r);t=U(t),t=_e(t),o=H(a,o),we(t,function(){Pt(`Cannot call ${t} due to unbound types`,d)},e-1),Z([],d,f=>{var m=[f[0],null].concat(f.slice(1));return $e(t,Xt(t,m,null,o,i),e-1),[]})},gn=(t,e,r)=>{switch(e){case 1:return r?a=>K[a]:a=>G[a];case 2:return r?a=>pt[a>>1]:a=>ot[a>>1];case 4:return r?a=>it[a>>2]:a=>E[a>>2];default:throw new TypeError(`invalid integer width (${e}): ${t}`)}},yn=(t,e,r,a,o)=>{e=U(e);const i=a===0;let c=d=>d;if(i){var u=32-8*r;c=d=>d<<u>>>u,o=c(o)}z(t,{name:e,fromWireType:c,toWireType:(d,f)=>f,readValueFromPointer:gn(e,r,a!==0),destructorFunction:null})},wn=(t,e,r)=>{var a=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],o=a[e];function i(c){var u=E[c>>2],d=E[c+4>>2];return new o(K.buffer,d,u)}r=U(r),z(t,{name:r,fromWireType:i,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},bn=Object.assign({optional:!0},Se),$n=(t,e)=>{z(t,bn)},Cn=(t,e,r,a)=>{if(!(a>0))return 0;for(var o=r,i=r+a-1,c=0;c<t.length;++c){var u=t.codePointAt(c);if(u<=127){if(r>=i)break;e[r++]=u}else if(u<=2047){if(r+1>=i)break;e[r++]=192|u>>6,e[r++]=128|u&63}else if(u<=65535){if(r+2>=i)break;e[r++]=224|u>>12,e[r++]=128|u>>6&63,e[r++]=128|u&63}else{if(r+3>=i)break;e[r++]=240|u>>18,e[r++]=128|u>>12&63,e[r++]=128|u>>6&63,e[r++]=128|u&63,c++}}return e[r]=0,r-o},at=(t,e,r)=>Cn(t,G,e,r),xe=t=>{for(var e=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a<=127?e++:a<=2047?e+=2:a>=55296&&a<=57343?(e+=4,++r):e+=3}return e},Ee=globalThis.TextDecoder&&new TextDecoder,De=(t,e,r,a)=>{var o=e+r;if(a)return o;for(;t[e]&&!(e>=o);)++e;return e},Oe=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;var o=De(t,e,r,a);if(o-e>16&&t.buffer&&Ee)return Ee.decode(t.subarray(e,o));for(var i="";e<o;){var c=t[e++];if(!(c&128)){i+=String.fromCharCode(c);continue}var u=t[e++]&63;if((c&224)==192){i+=String.fromCharCode((c&31)<<6|u);continue}var d=t[e++]&63;if((c&240)==224?c=(c&15)<<12|u<<6|d:c=(c&7)<<18|u<<12|d<<6|t[e++]&63,c<65536)i+=String.fromCharCode(c);else{var f=c-65536;i+=String.fromCharCode(55296|f>>10,56320|f&1023)}}return i},Tn=(t,e,r)=>t?Oe(G,t,e,r):"",_n=(t,e)=>{e=U(e),z(t,{name:e,fromWireType(r){var a=E[r>>2],o=r+4,i;return i=Tn(o,a,!0),J(r),i},toWireType(r,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var o,i=typeof a=="string";i||ArrayBuffer.isView(a)&&a.BYTES_PER_ELEMENT==1||_("Cannot pass non-string to std::string"),i?o=xe(a):o=a.length;var c=Zt(4+o+1),u=c+4;return E[c>>2]=o,i?at(a,u,o+1):G.set(a,u),r!==null&&r.push(J,c),c},readValueFromPointer:st,destructorFunction(r){J(r)}})},Ie=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,Pn=(t,e,r)=>{var a=t>>1,o=De(ot,a,e/2,r);if(o-a>16&&Ie)return Ie.decode(ot.subarray(a,o));for(var i="",c=a;c<o;++c){var u=ot[c];i+=String.fromCharCode(u)}return i},Sn=(t,e,r)=>{if(r!=null||(r=2147483647),r<2)return 0;r-=2;for(var a=e,o=r<t.length*2?r/2:t.length,i=0;i<o;++i){var c=t.charCodeAt(i);pt[e>>1]=c,e+=2}return pt[e>>1]=0,e-a},xn=t=>t.length*2,En=(t,e,r)=>{for(var a="",o=t>>2,i=0;!(i>=e/4);i++){var c=E[o+i];if(!c&&!r)break;a+=String.fromCodePoint(c)}return a},Dn=(t,e,r)=>{if(r!=null||(r=2147483647),r<4)return 0;for(var a=e,o=a+r-4,i=0;i<t.length;++i){var c=t.codePointAt(i);if(c>65535&&i++,it[e>>2]=c,e+=4,e+4>o)break}return it[e>>2]=0,e-a},On=t=>{for(var e=0,r=0;r<t.length;++r){var a=t.codePointAt(r);a>65535&&r++,e+=4}return e},In=(t,e,r)=>{r=U(r);var a,o,i;e===2?(a=Pn,o=Sn,i=xn):(a=En,o=Dn,i=On),z(t,{name:r,fromWireType:c=>{var u=E[c>>2],d=a(c+4,u*e,!0);return J(c),d},toWireType:(c,u)=>{typeof u!="string"&&_(`Cannot pass non-string to C++ string type ${r}`);var d=i(u),f=Zt(4+d+e);return E[f>>2]=d/e,o(u,f+4,d+e),c!==null&&c.push(J,f),f},readValueFromPointer:st,destructorFunction(c){J(c)}})},Mn=(t,e,r,a,o,i)=>{wt[t]={name:U(e),rawConstructor:H(r,a),rawDestructor:H(o,i),fields:[]}},An=(t,e,r,a,o,i,c,u,d,f)=>{wt[t].fields.push({fieldName:U(e),getterReturnType:r,getter:H(a,o),getterContext:i,setterArgumentType:c,setter:H(u,d),setterContext:f})},Fn=(t,e)=>{e=U(e),z(t,{isVoid:!0,name:e,fromWireType:()=>{},toWireType:(r,a)=>{}})},Kt=[],Rn=t=>{var e=Kt.length;return Kt.push(t),e},Ln=(t,e)=>{var r=Y[t];return r===void 0&&_(`${e} has unknown type ${Te(t)}`),r},jn=(t,e)=>{for(var r=new Array(t),a=0;a<t;++a)r[a]=Ln(E[e+a*4>>2],`parameter ${a}`);return r},Un=(t,e,r)=>{var a=[],o=t(a,r);return a.length&&(E[e>>2]=q.toHandle(a)),o},Bn={},Me=t=>{var e=Bn[t];return e===void 0?U(t):e},Wn=(t,e,r)=>{var a=8,[o,...i]=jn(t,e),c=o.toWireType.bind(o),u=i.map(v=>v.readValueFromPointer.bind(v));t--;var d=new Array(t),f=(v,x,O,A)=>{for(var M=0,I=0;I<t;++I)d[I]=u[I](A+M),M+=a;var D;switch(r){case 0:D=q.toValue(v).apply(null,d);break;case 2:D=Reflect.construct(q.toValue(v),d);break;case 3:D=d[0];break;case 1:D=q.toValue(v)[Me(x)](...d);break}return Un(c,O,D)},m=`methodCaller<(${i.map(v=>v.name)}) => ${o.name}>`;return Rn(qt(m,f))},kn=t=>t?(t=Me(t),q.toHandle(globalThis[t])):q.toHandle(globalThis),Vn=t=>{t>9&&(tt[t+1]+=1)},Hn=(t,e,r,a,o)=>Kt[t](e,r,a,o),zn=t=>{var e=q.toValue(t);Vt(e),Jt(t)},qn=(t,e,r,a)=>{var o=new Date().getFullYear(),i=new Date(o,0,1),c=new Date(o,6,1),u=i.getTimezoneOffset(),d=c.getTimezoneOffset(),f=Math.max(u,d);E[t>>2]=f*60,it[e>>2]=+(u!=d);var m=O=>{var A=O>=0?"-":"+",M=Math.abs(O),I=String(Math.floor(M/60)).padStart(2,"0"),D=String(M%60).padStart(2,"0");return`UTC${A}${I}${D}`},v=m(u),x=m(d);d<u?(at(v,r,17),at(x,a,17)):(at(v,a,17),at(x,r,17))},Gn=()=>2147483648,Nn=(t,e)=>Math.ceil(t/e)*e,Qn=t=>{var e=St.buffer.byteLength,r=(t-e+65535)/65536|0;try{return St.grow(r),de(),1}catch{}},Xn=t=>{var e=G.length;t>>>=0;var r=Gn();if(t>r)return!1;for(var a=1;a<=4;a*=2){var o=e*(1+.2/a);o=Math.min(o,t+100663296);var i=Math.min(r,Nn(Math.max(t,o),65536)),c=Qn(i);if(c)return!0}return!1},Yt={},Jn=()=>T||"./this.program",lt=()=>{if(!lt.strings){var t=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:Jn()};for(var r in Yt)Yt[r]===void 0?delete e[r]:e[r]=Yt[r];var a=[];for(var r in e)a.push(`${r}=${e[r]}`);lt.strings=a}return lt.strings},Kn=(t,e)=>{var r=0,a=0;for(var o of lt()){var i=e+r;E[t+a>>2]=i,r+=at(o,i,1/0)+1,a+=4}return 0},Yn=(t,e)=>{var r=lt();E[t>>2]=r.length;var a=0;for(var o of r)a+=xe(o)+1;return E[e>>2]=a,0},Zn=t=>52;function ta(t,e,r,a,o){return 70}var ea=[null,[],[]],ra=(t,e)=>{var r=ea[t];e===0||e===10?((t===1?k:W)(Oe(r)),r.length=0):r.push(e)},na=(t,e,r,a)=>{for(var o=0,i=0;i<r;i++){var c=E[e>>2],u=E[e+4>>2];e+=8;for(var d=0;d<u;d++)ra(t,G[c+d]);o+=u}return E[a>>2]=o,0},aa=t=>t;if(qr(),nn(),h.noExitRuntime&&h.noExitRuntime,h.print&&(k=h.print),h.printErr&&(W=h.printErr),h.wasmBinary&&(V=h.wasmBinary),h.arguments&&h.arguments,h.thisProgram&&(T=h.thisProgram),h.preInit)for(typeof h.preInit=="function"&&(h.preInit=[h.preInit]);h.preInit.length>0;)h.preInit.shift()();var Ae,J,Zt,Fe,y,Re,Le,je,Ue,Be,We,ke,Ve,St,He;function oa(t){Ae=t.ya,J=h._free=t.za,Zt=h._malloc=t.Ba,Fe=t.Ca,y=t.Da,Re=t.Ea,Le=t.Fa,je=t.Ga,Ue=t.Ha,Be=t.Ia,We=t.Ja,X.viijii=t.Ka,ke=X.iiijj=t.La,X.jiji=t.Ma,Ve=X.jiiii=t.Na,X.iiiiij=t.Oa,X.iiiiijj=t.Pa,X.iiiiiijj=t.Qa,St=t.wa,He=t.Aa}var ia={s:Er,w:Dr,a:Or,j:Ir,m:Mr,Q:Ar,p:Fr,U:Rr,d:Lr,ca:jr,ta:Br,ba:Wr,oa:Vr,ra:un,qa:dn,H:hn,ma:fn,X:mn,Y:vn,x:yn,t:wn,sa:$n,na:_n,R:In,I:Mn,ua:An,pa:Fn,N:Wn,va:Jt,D:kn,S:Vn,M:Hn,ia:zn,da:qn,ga:Xn,ea:Kn,fa:Yn,ha:Zn,$:ta,V:na,K:Da,C:Ma,Z:fa,T:Ua,r:Pa,b:da,E:Ea,ka:Fa,c:pa,ja:Ra,h:ha,i:ga,q:$a,P:xa,v:Ta,F:_a,L:Sa,z:Aa,J:Ba,aa:Wa,_:ka,f:ma,l:sa,e:la,g:ua,O:ja,k:ca,la:Oa,o:Ca,B:ya,u:Ia,W:ba,A:La,n:va,G:wa,y:aa};function sa(t,e){var r=b();try{$(t)(e)}catch(a){if(w(r),a!==a+0)throw a;y(1,0)}}function ca(t,e,r,a,o){var i=b();try{$(t)(e,r,a,o)}catch(c){if(w(i),c!==c+0)throw c;y(1,0)}}function ua(t,e,r,a){var o=b();try{$(t)(e,r,a)}catch(i){if(w(o),i!==i+0)throw i;y(1,0)}}function la(t,e,r){var a=b();try{$(t)(e,r)}catch(o){if(w(a),o!==o+0)throw o;y(1,0)}}function da(t,e){var r=b();try{return $(t)(e)}catch(a){if(w(r),a!==a+0)throw a;y(1,0)}}function ha(t,e,r,a){var o=b();try{return $(t)(e,r,a)}catch(i){if(w(o),i!==i+0)throw i;y(1,0)}}function fa(t,e,r,a,o,i){var c=b();try{return $(t)(e,r,a,o,i)}catch(u){if(w(c),u!==u+0)throw u;y(1,0)}}function pa(t,e,r){var a=b();try{return $(t)(e,r)}catch(o){if(w(a),o!==o+0)throw o;y(1,0)}}function ma(t){var e=b();try{$(t)()}catch(r){if(w(e),r!==r+0)throw r;y(1,0)}}function va(t,e,r,a,o,i,c,u,d,f,m){var v=b();try{$(t)(e,r,a,o,i,c,u,d,f,m)}catch(x){if(w(v),x!==x+0)throw x;y(1,0)}}function ga(t,e,r,a,o){var i=b();try{return $(t)(e,r,a,o)}catch(c){if(w(i),c!==c+0)throw c;y(1,0)}}function ya(t,e,r,a,o,i,c){var u=b();try{$(t)(e,r,a,o,i,c)}catch(d){if(w(u),d!==d+0)throw d;y(1,0)}}function wa(t,e,r,a,o,i,c,u,d,f,m,v,x,O,A,M){var I=b();try{$(t)(e,r,a,o,i,c,u,d,f,m,v,x,O,A,M)}catch(D){if(w(I),D!==D+0)throw D;y(1,0)}}function ba(t,e,r,a,o,i,c,u,d){var f=b();try{$(t)(e,r,a,o,i,c,u,d)}catch(m){if(w(f),m!==m+0)throw m;y(1,0)}}function $a(t,e,r,a,o,i){var c=b();try{return $(t)(e,r,a,o,i)}catch(u){if(w(c),u!==u+0)throw u;y(1,0)}}function Ca(t,e,r,a,o,i){var c=b();try{$(t)(e,r,a,o,i)}catch(u){if(w(c),u!==u+0)throw u;y(1,0)}}function Ta(t,e,r,a,o,i,c){var u=b();try{return $(t)(e,r,a,o,i,c)}catch(d){if(w(u),d!==d+0)throw d;y(1,0)}}function _a(t,e,r,a,o,i,c,u){var d=b();try{return $(t)(e,r,a,o,i,c,u)}catch(f){if(w(d),f!==f+0)throw f;y(1,0)}}function Pa(t){var e=b();try{return $(t)()}catch(r){if(w(e),r!==r+0)throw r;y(1,0)}}function Sa(t,e,r,a,o,i,c,u,d){var f=b();try{return $(t)(e,r,a,o,i,c,u,d)}catch(m){if(w(f),m!==m+0)throw m;y(1,0)}}function xa(t,e,r,a,o,i,c){var u=b();try{return $(t)(e,r,a,o,i,c)}catch(d){if(w(u),d!==d+0)throw d;y(1,0)}}function Ea(t,e,r,a){var o=b();try{return $(t)(e,r,a)}catch(i){if(w(o),i!==i+0)throw i;y(1,0)}}function Da(t,e,r,a){var o=b();try{return $(t)(e,r,a)}catch(i){if(w(o),i!==i+0)throw i;y(1,0)}}function Oa(t,e,r,a,o,i,c,u){var d=b();try{$(t)(e,r,a,o,i,c,u)}catch(f){if(w(d),f!==f+0)throw f;y(1,0)}}function Ia(t,e,r,a,o,i,c,u){var d=b();try{$(t)(e,r,a,o,i,c,u)}catch(f){if(w(d),f!==f+0)throw f;y(1,0)}}function Ma(t,e,r,a,o,i){var c=b();try{return $(t)(e,r,a,o,i)}catch(u){if(w(c),u!==u+0)throw u;y(1,0)}}function Aa(t,e,r,a,o,i,c,u,d,f){var m=b();try{return $(t)(e,r,a,o,i,c,u,d,f)}catch(v){if(w(m),v!==v+0)throw v;y(1,0)}}function Fa(t,e,r){var a=b();try{return $(t)(e,r)}catch(o){if(w(a),o!==o+0)throw o;y(1,0)}}function Ra(t,e,r,a,o){var i=b();try{return $(t)(e,r,a,o)}catch(c){if(w(i),c!==c+0)throw c;y(1,0)}}function La(t,e,r,a,o,i,c,u,d,f){var m=b();try{$(t)(e,r,a,o,i,c,u,d,f)}catch(v){if(w(m),v!==v+0)throw v;y(1,0)}}function ja(t,e,r,a,o,i,c){var u=b();try{$(t)(e,r,a,o,i,c)}catch(d){if(w(u),d!==d+0)throw d;y(1,0)}}function Ua(t,e,r,a){var o=b();try{return $(t)(e,r,a)}catch(i){if(w(o),i!==i+0)throw i;y(1,0)}}function Ba(t,e,r,a,o,i,c,u,d,f,m,v){var x=b();try{return $(t)(e,r,a,o,i,c,u,d,f,m,v)}catch(O){if(w(x),O!==O+0)throw O;y(1,0)}}function Wa(t,e,r,a,o,i,c){var u=b();try{return ke(t,e,r,a,o,i,c)}catch(d){if(w(u),d!==d+0)throw d;y(1,0)}}function ka(t,e,r,a,o){var i=b();try{return Ve(t,e,r,a,o)}catch(c){if(w(i),c!==c+0)throw c;y(1,0)}}function Va(){vr();function t(){var e,r;h.calledRun=!0,!rt&&(gr(),(e=ft)===null||e===void 0||e(h),(r=h.onRuntimeInitialized)===null||r===void 0||r.call(h),yr())}h.setStatus?(h.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>h.setStatus(""),1),t()},1)):t()}var dt;return dt=await Pr(),Va(),le?s=h:s=new Promise((t,e)=>{ft=t,se=e}),s}function wo(n){return nr(ar,n)}async function bo(n,s){return yo(ar,n,s)}const or=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["databar_limited","DataBarLimited"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"],["any","Any"]],$o=[...or,["unknown"]].map(n=>n[0]),re=new Map(or);function Co(n){for(const[s,l]of re)if(n===l)return s;return"unknown"}function To(n){if(ir(n))return{width:n.naturalWidth,height:n.naturalHeight};if(sr(n))return{width:n.width.baseVal.value,height:n.height.baseVal.value};if(cr(n))return{width:n.videoWidth,height:n.videoHeight};if(lr(n))return{width:n.width,height:n.height};if(hr(n))return{width:n.displayWidth,height:n.displayHeight};if(ur(n))return{width:n.width,height:n.height};if(dr(n))return{width:n.width,height:n.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function ir(n){var s,l;try{return n instanceof((l=(s=n==null?void 0:n.ownerDocument)==null?void 0:s.defaultView)==null?void 0:l.HTMLImageElement)}catch{return!1}}function sr(n){var s,l;try{return n instanceof((l=(s=n==null?void 0:n.ownerDocument)==null?void 0:s.defaultView)==null?void 0:l.SVGImageElement)}catch{return!1}}function cr(n){var s,l;try{return n instanceof((l=(s=n==null?void 0:n.ownerDocument)==null?void 0:s.defaultView)==null?void 0:l.HTMLVideoElement)}catch{return!1}}function ur(n){var s,l;try{return n instanceof((l=(s=n==null?void 0:n.ownerDocument)==null?void 0:s.defaultView)==null?void 0:l.HTMLCanvasElement)}catch{return!1}}function lr(n){try{return n instanceof ImageBitmap||Object.prototype.toString.call(n)==="[object ImageBitmap]"}catch{return!1}}function dr(n){try{return n instanceof OffscreenCanvas||Object.prototype.toString.call(n)==="[object OffscreenCanvas]"}catch{return!1}}function hr(n){try{return n instanceof VideoFrame||Object.prototype.toString.call(n)==="[object VideoFrame]"}catch{return!1}}function _o(n){try{return n instanceof Blob||Object.prototype.toString.call(n)==="[object Blob]"}catch{return!1}}function Po(n){try{return n instanceof ImageData||Object.prototype.toString.call(n)==="[object ImageData]"}catch{return!1}}function So(n,s){try{const l=new OffscreenCanvas(n,s);if(l.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return l;throw void 0}catch{const l=document.createElement("canvas");return l.width=n,l.height=s,l}}async function fr(n){if(ir(n)&&!await Oo(n))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(sr(n)&&!await Io(n))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(hr(n)&&Mo(n))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(cr(n)&&(n.readyState===0||n.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(lr(n)&&Fo(n))throw new DOMException("The image source is detached.","InvalidStateError");const{width:s,height:l}=To(n);if(s===0||l===0)return null;const p=So(s,l).getContext("2d");p.drawImage(n,0,0);try{return p.getImageData(0,0,s,l)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function xo(n){let s;try{s=await createImageBitmap(n)}catch{try{if(globalThis.Image){s=new Image;let l="";try{l=URL.createObjectURL(n),s.src=l,await s.decode()}finally{URL.revokeObjectURL(l)}}else return n}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}}return await fr(s)}function Eo(n){const{width:s,height:l}=n;if(s===0||l===0)return null;const p=n.getContext("2d");try{return p.getImageData(0,0,s,l)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Do(n){if(_o(n))return await xo(n);if(Po(n)){if(Ao(n))throw new DOMException("The image data has been detached.","InvalidStateError");return n}return ur(n)||dr(n)?Eo(n):await fr(n)}async function Oo(n){try{return await n.decode(),!0}catch{return!1}}async function Io(n){var s;try{return await((s=n.decode)==null?void 0:s.call(n)),!0}catch{return!1}}function Mo(n){return n.format===null}function Ao(n){return n.data.buffer.byteLength===0}function Fo(n){return n.width===0&&n.height===0}function Ye(n,s){return Ro(n)?new DOMException(`${s}: ${n.message}`,n.name):Lo(n)?new n.constructor(`${s}: ${n.message}`):new Error(`${s}: ${n}`)}function Ro(n){return n instanceof DOMException||Object.prototype.toString.call(n)==="[object DOMException]"}function Lo(n){return n instanceof Error||Object.prototype.toString.call(n)==="[object Error]"}var At;class ht{constructor(s={}){Za(this,At);var l;try{const p=(l=s==null?void 0:s.formats)==null?void 0:l.filter(h=>h!=="unknown");if((p==null?void 0:p.length)===0)throw new TypeError("Hint option provided, but is empty.");for(const h of p??[])if(!re.has(h))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${h}' is not a valid enum value of type BarcodeFormat.`);to(this,At,p??[]),wo({fireImmediately:!0}).catch(()=>{})}catch(p){throw Ye(p,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return $o.filter(s=>s!=="unknown")}async detect(s){try{const l=await Do(s);if(l===null)return[];let p;const h={tryCode39ExtendedMode:!1,textMode:"Plain",formats:Ya(this,At).map(g=>re.get(g))};try{p=await bo(l,h)}catch(g){throw console.error(g),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return p.map(g=>{const{topLeft:{x:C,y:P},topRight:{x:T,y:S},bottomLeft:{x:F,y:R},bottomRight:{x:L,y:j}}=g.position,k=Math.min(C,T,F,L),W=Math.min(P,S,R,j),V=Math.max(C,T,F,L),rt=Math.max(P,S,R,j);return{boundingBox:new DOMRectReadOnly(k,W,V-k,rt-W),rawValue:g.text,format:Co(g.format),cornerPoints:[{x:C,y:P},{x:T,y:S},{x:L,y:j},{x:F,y:R}]}})}catch(l){throw Ye(l,"Failed to execute 'detect' on 'BarcodeDetector'")}}}At=new WeakMap;globalThis.BarcodeDetector!=null||(globalThis.BarcodeDetector=ht);const jo=n=>{let s=!1,l;return(...p)=>(s||(l=n(...p),s=!0),l)},pr=(n,s)=>new Promise(l=>{const p=h=>{n.removeEventListener(s,p),l(h)};n.addEventListener(s,p)}),Uo=n=>new Promise(s=>{setTimeout(s,n)}),oe=n=>{if(n.length>0){const[s]=n,[l,p,h,g]=s.cornerPoints;return{content:s.rawValue,location:{topLeftCorner:l,topRightCorner:p,bottomRightCorner:h,bottomLeftCorner:g,topLeftFinderPattern:{},topRightFinderPattern:{},bottomLeftFinderPattern:{}},imageData:null,binaryData:null}}else return{content:null,location:null,imageData:null,binaryData:null}},Bo=(n,s)=>{const l=new ht({formats:["qr_code"]}),{detectHandler:p,locateHandler:h,minDelay:g}=s,C=P=>async T=>{if(n.readyState>1){const{lastScanned:S,contentBefore:F,locationBefore:R}=P;if(T-S>=g){const L=await l.detect(n),{content:j,location:k,imageData:W,binaryData:V}=oe(L);j!==null&&j!==F&&p({content:j,location:k,imageData:W,binaryData:V}),(k!==null||R!==null)&&h(L),window.requestAnimationFrame(C({lastScanned:T,contentBefore:j??F,locationBefore:k}))}else window.requestAnimationFrame(C(P))}};C({contentBefore:null,locationBefore:null,lastScanned:performance.now()})(performance.now())},Wo=async n=>{if(n.startsWith("http")&&n.includes(location.host)===!1)throw new Ja;const s=document.createElement("img");return s.src=n,await pr(s,"load"),s},mr=async n=>{const l=await new ht({formats:["qr_code"]}).detect(n);return oe(l)},ko=async n=>{const s=new ht({formats:["qr_code"]}),l=await Wo(n),p=await s.detect(l);return oe(p)},Vo=async()=>{const[n,s,l,p]=await Promise.all([Ot(()=>import("./adapter_core.CEti_sgG.js"),__vite__mapDeps([0,1,2,3,4])),Ot(()=>import("./getusermedia.D3hymGKc.js"),__vite__mapDeps([2,1])),Ot(()=>import("./getusermedia.D7MBqdid.js"),__vite__mapDeps([3,1])),Ot(()=>import("./safari_shim.tcOtNX9D.js").then(h=>h.s),__vite__mapDeps([4,1]))]);return{adapter:n.default??n,chromeShim:s.shimGetUserMedia,firefoxShim:l.shimGetUserMedia,safariShim:p.shimGetUserMedia}},Ho=jo(async()=>{if(typeof window>"u")return;const{adapter:n,chromeShim:s,firefoxShim:l,safariShim:p}=await Vo();switch(n.browserDetails.browser){case"chrome":s(window,n.browserDetails);break;case"firefox":l(window,n.browserDetails);break;case"safari":p(window,n.browserDetails);break;case"edge":s(window,n.browserDetails);break;default:throw new tr}});class zo{constructor(s,l){this.videoEl=s,this.stream=l}stop(){this.videoEl.srcObject=null,this.stream.getTracks().forEach(s=>{this.stream.removeTrack(s),s.stop()})}getCapabilities(){var l;const[s]=this.stream.getVideoTracks();return((l=s==null?void 0:s.getCapabilities)==null?void 0:l.call(s))??{}}}const qo=async n=>{const s=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:l})=>l==="videoinput");if(s.length>=2){const l=s[0],p=s[s.length-1];switch(n){case"auto":return{deviceId:{exact:p.deviceId}};case"rear":return{deviceId:{exact:p.deviceId}};case"front":return{deviceId:{exact:l.deviceId}};default:return}}else switch(n){case"auto":return{facingMode:{ideal:"environment"}};case"rear":return{facingMode:{exact:"environment"}};case"front":return{facingMode:{exact:"user"}};default:return}};async function Go(n,{camera:s,torch:l}){var T;if(window.isSecureContext!==!0)throw new Ka;if(((T=navigator==null?void 0:navigator.mediaDevices)==null?void 0:T.getUserMedia)===void 0)throw new tr;await Ho();const p={audio:!1,video:{width:{min:360,ideal:640,max:1920},height:{min:240,ideal:480,max:1080},...await qo(s)}},h=await navigator.mediaDevices.getUserMedia(p),g=n,C=n,P=window;if(C.srcObject!==void 0)C.srcObject=h;else if(g.mozSrcObject!==void 0)g.mozSrcObject=h;else if(typeof window.URL.createObjectURL=="function"){const S=window.URL.createObjectURL(h);g.src=S}else if(P.webkitURL!==void 0&&typeof P.webkitURL.createObjectURL=="function"){const S=P.webkitURL.createObjectURL(h);g.src=S}else g.src=h;if(await pr(n,"loadeddata"),await Uo(500),l){const[S]=h.getVideoTracks();if(S.getCapabilities().torch){const L={torch:!0};S.applyConstraints({advanced:[L]})}else console.warn("device does not support torch capability")}return new zo(n,h)}const ie={beforeMount(){const n=window;n.BarcodeDetector=ht},methods:{async onDetect(n){this.$emit("detect",n);try{const{content:s}=await n;s!==null&&this.$emit("decode",s)}catch{}}}},No={name:"qrcode-stream",mixins:[ie],props:{camera:{type:String,default:"auto",validator(n){return["auto","rear","front","off"].includes(n)}},torch:{type:Boolean,default:!1},track:{type:Function}},data(){return{cameraInstance:null,mounted:!1}},computed:{shouldStream(){return this.mounted&&this.camera!=="off"},shouldScan(){return this.shouldStream===!0&&this.cameraInstance!==null},scanInterval(){return this.track===void 0?500:40}},watch:{shouldStream(n){if(!n){const s=this.$refs.pauseFrame,l=s.getContext("2d"),p=this.$refs.video;s.width=p.videoWidth,s.height=p.videoHeight,l==null||l.drawImage(p,0,0,p.videoWidth,p.videoHeight)}},shouldScan(n){n&&(this.clearCanvas(this.$refs.pauseFrame),this.clearCanvas(this.$refs.trackingLayer),this.startScanning())},torch(){this.init()},camera(){this.init()}},mounted(){this.init(),this.mounted=!0},beforeUnmount(){this.beforeResetCamera(),this.mounted=!1},methods:{init(){const n=(async()=>{if(this.beforeResetCamera(),this.camera==="off")return this.cameraInstance=null,{capabilities:{}};{this.cameraInstance=await Go(this.$refs.video,{camera:this.camera,torch:this.torch});const s=this.cameraInstance.getCapabilities();return this.mounted||this.cameraInstance.stop(),{capabilities:s}}})();this.$emit("init",n)},startScanning(){const n=s=>{this.onDetect(Promise.resolve(s))};Bo(this.$refs.video,{detectHandler:n,locateHandler:this.onLocate,minDelay:this.scanInterval})},beforeResetCamera(){this.cameraInstance!==null&&(this.cameraInstance.stop(),this.cameraInstance=null)},onLocate(n){const s=this.$refs.trackingLayer,l=this.$refs.video;if(s!==void 0)if(n.length>0&&this.track!==void 0&&l!==void 0){const p=({x:C,y:P})=>{const T=l.offsetWidth,S=l.offsetHeight,F=l.videoWidth,R=l.videoHeight,L=Math.max(T/F,S/R),j=F*L,k=R*L,W=j/F,V=k/R,rt=(T-j)/2,ft=(S-k)/2;return{x:Math.floor(C*W+rt),y:Math.floor(P*V+ft)}},h=n.map(C=>{const{boundingBox:P,cornerPoints:T}=C,{x:S,y:F}=p({x:P.x,y:P.y}),{x:R,y:L}=p({x:P.width,y:P.height});return{...C,cornerPoints:T.map(p),boundingBox:DOMRectReadOnly.fromRect({x:S,y:F,width:R,height:L})}});s.width=l.offsetWidth,s.height=l.offsetHeight;const g=s.getContext("2d");this.track(h,g)}else this.clearCanvas(s)},clearCanvas(n){const s=n.getContext("2d");s==null||s.clearRect(0,0,n.width,n.height)}}},Qo={class:"qrcode-stream-wrapper"},Xo={ref:"video",class:"qrcode-stream-camera",autoplay:"",muted:"",playsinline:""},Jo={ref:"pauseFrame",class:"qrcode-stream-camera"},Ko={ref:"trackingLayer",class:"qrcode-stream-overlay"},Yo={class:"qrcode-stream-overlay"};function Zo(n,s,l,p,h,g){return Lt(),ae("div",Qo,[Qe(It("video",Xo,null,512),[[Xe,g.shouldScan]]),Qe(It("canvas",Jo,null,512),[[Xe,!g.shouldScan]]),It("canvas",Ko,null,512),It("div",Yo,[Ze(n.$slots,"default",{},void 0,!0)])])}const ti=ne(No,[["render",Zo],["__scopeId","data-v-82098419"]]),ei={name:"qrcode-capture",mixins:[ie],methods:{onChangeInput(n){[...n.target.files||[]].map(mr).forEach(this.onDetect)}}};function ri(n,s,l,p,h,g){return Lt(),ae("input",{onChange:s[0]||(s[0]=(...C)=>g.onChangeInput&&g.onChangeInput(...C)),type:"file",name:"image",accept:"image/*",capture:"environment",multiple:""},null,32)}const ni=ne(ei,[["render",ri]]),ai={name:"qrcode-drop-zone",mixins:[ie],methods:{onDragOver(n){this.$emit("dragover",n)},onDrop({dataTransfer:n}){this.onDragOver(!1);const s=[...(n==null?void 0:n.files)||[]],l=(n==null?void 0:n.getData("text/uri-list"))||"";s.forEach(p=>{this.onDetect(mr(p))}),l!==""&&this.onDetect(ko(l))}}};function oi(n,s,l,p,h,g){return Lt(),ae("div",{onDrop:s[0]||(s[0]=Mt((...C)=>g.onDrop&&g.onDrop(...C),["prevent","stop"])),onDragenter:s[1]||(s[1]=Mt(C=>g.onDragOver(!0),["prevent","stop"])),onDragleave:s[2]||(s[2]=Mt(C=>g.onDragOver(!1),["prevent","stop"])),onDragover:s[3]||(s[3]=Mt(()=>{},["prevent","stop"]))},[Ze(n.$slots,"default")],32)}const ii=ne(ai,[["render",oi]]);function si(n){n.component("qrcode-stream",ti),n.component("qrcode-capture",ni),n.component("qrcode-drop-zone",ii)}const ci={install:si};let Rt=null;typeof window<"u"?Rt=window.Vue??null:Rt=globalThis.Vue??null;Rt&&Rt.use(ci);export{ii as Q,li as _,ti as a,ni as b};
